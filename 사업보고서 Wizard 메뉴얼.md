# 사업보고서 Wizard 메뉴얼
[사업보고서 Wizard 메뉴얼 사이트 바로가기](https://assuranceda.github.io/BusinessReport_Wizard/)

___
# 1. 실행 클라이언트 가이드
## (1) 로그인 단계
### 1) 최초 회원가입 - Workbench
#### Workbench Account Activate(회원가입)
1) PwC 삼일회계법인 담당자가 고객사의 이메일을 시스템에 등록하게 되면 아래와 같이 Activate 이메일이 오게 되며, 하단에 Activate your accout를 누르면 로그인 페이지로 이동합니다.

<br>

![activation_email.png](../../_resources/activation_email.png)
<br>

2) Activate 페이지에서 메일주소, 비밀번호, 국가코드(+82), 휴대폰번호를 입력합니다.

![sign_in.png](../../_resources/sign_in.png)

<br>

3) 문자 혹은 전화로 전달받은 코드를 입력하여 인증을 수행합니다.
<br>

![phone_verification.png](../../_resources/phone_verification.png)
<br>

![phone_verification2.png](../../_resources/phone_verification2.png)
<br>

4) 가입절차가 완료 되었습니다.
<br>

![activation_success.png](../../_resources/activation_success.png)
<br>

### 2) 로그인 절차
#### 클라이언트 실행 이후 로그인 단계
1. 로그인 메일주소에 상단에서 activate한 이메일을 입력한 후 확인을 누릅니다.
<br>
![5764fc80cef10a4bcb0d97c4992b04d7.png](../../_resources/5764fc80cef10a4bcb0d97c4992b04d7.png)
<br>

2. 비밀번호를 입력하고 확인을 누릅니다.
<br>
![75f46d5aa3e9745fbe330fa0ee1ddee3.png](../../_resources/75f46d5aa3e9745fbe330fa0ee1ddee3.png)
<br>

3. 2차 인증 수단을 선택한 후 확인을 누릅니다.
<br>
![433c3767ad19d307a88aaf5db5eeb5ab.png](../../_resources/433c3767ad19d307a88aaf5db5eeb5ab.png)
<br>

4. 전달받은 인증 코드를 입력한 후 확인을 누릅니다.
<br>

![90ac9c26fb901f3775fdb26344e8caff.png](../../_resources/90ac9c26fb901f3775fdb26344e8caff.png)
<br>
___

## (2) Initial Template 생성
### 1) 단계 설명
**본 단계는 최초 사업보고서 Initial Template를 생성하는 단계입니다.<br>**
다음의 자료를 토대로 엑셀 기반의 사업보고서 작성을 위한 Template를 생성합니다.

작성 대상 **보고서 유형(사업/반기/분기보고서)** 을 선택 후 아래 데이터를 선택해주시기 바랍니다.

(1) 작업대상 DSD 
(2) 사업보고서 작성 부서 엑셀 파일

<br>

### 2) 클라이언트 화면

![69c75a43b00b5f46b723f80c3659217f.png](../../_resources/69c75a43b00b5f46b723f80c3659217f.png)
<br>

### 3) 사업보고서 작성 부서 엑셀 파일 작성
작성 부서 엑셀 파일 A열에 아래와 같이 부서명을 아래 방향으로 기재합니다.
만일 동일 부서 내 담당자가 여러명인 경우 회계팀1 / 회계팀2 등으로 기재 부탁 드립니다.

![department_xlsx.jpg](../../_resources/department_xlsx.jpg)

<br>

___
## (3) 부서별 Template 생성
### 1) 단계 설명
**Initial Template 단계에서 생성된 엑셀 파일(xlsm)을 토대로 작성 부서 별 엑셀 파일(xlsm) N개를 생성합니다.**

Initial Template를 기반으로 아래와 같은 작업을 진행해주셔야 합니다.

(1) 사업보고서 작성 영역을 각 사업부 R&R에 맞게 분배 
(2) 사업보고서 내용 상 검증이 필요한 금액의 경우 검증표 작성
(3) 부서별 Template 생성 결과인 separate_template 폴더 sharepoint 상에 업로드

<br>

### 2) 클라이언트 화면

![client_step2.jpg](../../_resources/client_step2.jpg)

<br>

### 3) 부서 맵핑
#### 부서 맵핑 개요 (DSD 시트 상 B~N열)
아래 화면에서 회계팀에서 빨간색으로 표시된 영역이 배정되었습니다.(10~13행)
또한 표의 영역이기 때문에  "⤷테이블 끝" 부분까지 올바르게 할당된 것을 알 수 있습니다.

- 회계팀에게 관련 부분을 배정하기 위해서는 회계팀의 열인 D열에 관련 영역을 O 표시하시면 됩니다.
<br>

>  Initial Template 상 DSD 시트

![DSDsheet1.jpg](../../_resources/DSDsheet1.jpg)
<br>


#### 기본 작성 방법
1. 위의 화면 상 B~L열에 대해서 BA열의 전년 동기 사업보고서 내용을 보시고 사업보고서 작성 부서(R&R)를 O 표시로 표시해주시기 바랍니다.
2. 감사보고서와 연결 감사보고서 내용은 각각 스마트리뷰어_별도(M열), 스마트리뷰어_연결(N열)로 자동 맵핑되어 있습니다. 1의 작업 시 이 부분은 생략하고 진행해주시면 되겠습니다.
3. 사업보고서 상 각 영역은 **하나의 부서**에게 할당 되어야 합니다.<br> 예를들어 하나의 표를 2개의 다른 부서에게 할당하는 것은 불가능합니다. 
4. 🚫 특히 필수 표의 경우 **Dart 표준 양식 상 반드시 지켜져야 하는 형식이 존재**하며, 여러 부서에게 할당되지 않도록 각별한 주의가 필요합니다.
5. 표의 경우 "⤷테이블 끝"까지 표의 영역이오니, 표의 영역을 할당하실 때에는 해당 부분까지 포함될 수 있도록 확인 부탁 드립니다.
<br>
#### 🚫 주의사항 - 다음과 같은 경우 오류가 발생합니다.
1. 하나의 필수 표 영역에 대해서 해당 영역의 일부 또는 전부를 다수의 부서에 배정하는 경우  
2. 사업보고서 상 동일 영역을 다수의 부서에 배정하는 경우
> Ex) 사업보고서라는 제목(6행)을 회계팀, 법무팀 등에 동시에 배정한 경우

<br>

### 4) 검증표 작성

#### 검증표 작성 개요
아래 화면 상 자금팀과 회계팀의 자본금은 동일하나, 경영기획팀의 자본금이 상이한 것을 알 수 있습니다.
관련 부분을 최초에 한번만 맵핑해주게 되면 추후 부서별 Template으로 나누어져서 새롭게 수식이 업데이트 되어도 작성된 검증표에 대한 링크가 연결됩니다.

![ref_table1.jpg](../../_resources/ref_table1.jpg)

#### 기본 작성 방법
1. 모든 열은 작성이 되어 있어야 합니다.

2. 변수_ID는 다음과 같은 규칙으로 이루어져 있습니다.
	- "그룹번호-일련번호"
	- 같은 그룹 내 부여된 일련번호는 동일한 금액을 가져야 한다는 로직으로 검증이 진행됩니다.
	> Ex) 검증표 상 "그룹번호 101" 상 일련번호 001 / 002 / 003이 존재합니다.<br> 이때 자금팀과 회계팀의 금액은 382로 일치하나 경영기획팀의 금액은 261,911로 다른 팀의 금액들과 다릅니다.

3. 변수_이름과 비고는 자유로이 적어주시되, 서로 Refernce 되는 항목들은 동일하게 기재 부탁 드립니다.

4. 금액은 "DSD" 시트 상에서 셀 참조로 작성해주셔야 하며(ex: =DSD!BA54),
참조된 셀에 표시된 DSD 시트 상 부서 맵핑(동그라미(O) 표시)과 검증표 상 부서명은 일치해야 합니다.

5. 부서명은 5를 고려하여 작성해주시기 바랍니다.
<br>

#### 🚫 주의사항 - 다음과 같은 경우 **검증 오류로 Template 생성이 중단** 됩니다.
검증표 검증 실패로 인해 Template 생성이 중단될 시 검증 실패 내역 정리된 엑셀 파일을 통해 검증표 수정 후 재 시도 부탁 드립니다.(TBD)

1. DSD 시트 상 "회계부"에 동그라미(O) 표시 되어 있는 행과 관련 된 금액을 검증표 상 "자금부"의 금액으로 입력한 경우
2. 금액열을 DSD 상 셀 참조가 아닌 숫자로 Key-in하는 경우
<br>

### 5) 최종 파일 리스트 작성

#### 관련 개요
부서별 Template 생성을 진행하시게 되면 아래와 같이 사업보고서 Wizard가 위치하는 폴더에 separate_template 폴더가 생성됩니다.
해당 separate_template 폴더 안에는 각 부서별 폴더 및 부서별 Template이 위치하게 됩니다.

#### 해당 안의 파일을 Sharepoint 상 각 부서 폴더 안으로 업로드하여 작성 부서 별로 사업보고서 작성을 진행해주시면 되겠습니다.

이때, 스마트리뷰어_별도 및 스마트리뷰어_연결 폴더의 경우 최초 생성 시에 **빈 폴더**로 생성되며,<br> 회계팀에서 작성하신 **스마트리뷰어 파일을 관련 폴더**에 넣어주시기 바랍니다.
(ixd를 첨부하시거나 스마트리뷰어를 사용하시지 않는 경우 빈 폴더로 남겨두시면 됩니다.)

![separate_template.jpg](../../_resources/separate_template.jpg)
<br>

"최종 파일 리스트.xlsx"는 자동으로 생성되며, 최초 생성 시 스마트리뷰어 파일명을 확장자(.xlsm)와 함께 입력 부탁 드리겠습니다.<br>
만일 관련 파일명이나 폴더명이 변경된 경우 (3) 사업보고서 최종 DSD 생성 전 "최종 파일 리스트.xlsx"를 업데이트 해주셔야 합니다.

**🚫 "최종 파일 리스트.xlsx"의 이름은 고정 값으로 변경하셔서는 안됩니다.**

![final_file_list.jpg](../../_resources/final_file_list.jpg)


<br>

___
## (4) 사업보고서 최종 DSD 생성
### 1) 단계 설명
**본 단계는 작성 부서 별 엑셀 파일(xlsm)을 토대로 최종적으로 사업보고서 DSD를 생성합니다.**
부서 별 Template를 기반으로 아래와 같은 작업을 진행해주셔야 합니다.

(1) 부서 별 Template 작성 가이드에 맞게 사업보고서 작성 및 검증 수행

(2) Sharepoint에서 작성된 Template을 하나의 압축 파일로 다운로드
( "최종 파일 리스트.xlsx" 작성 확인 필요)

<br>

### 2) 클라이언트 화면

![client_step3.jpg](../../_resources/client_step3.jpg)

<br>

___
## (5) Initial Rolling 작업
### 1) 단계 설명
**본 단계는 최초 사업보고서 Initial Template를 생성하는 단계입니다. Initial Template 생성 시 기존에 부서 맵핑 및 검증표 작성을 하신 경우 이를 반영하여 템플릿을 생성합니다.
<br>**

아래 작업이 수행된 사업보고서 Template이 필요합니다.

(1) 사업보고서 작성 영역을 각 사업부 R&R에 맞게 분배 
(2) 사업보고서 내용 상 검증이 필요한 금액의 경우 검증표 작성(선택사항)

작성 대상 **보고서 유형(사업/반기/분기보고서)** 을 선택 후 아래 데이터를 선택해주시기 바랍니다.

(1) 부서 맵핑 및 검증표 작성(선택)된 사업보고서 Template
(2) 최신 사업보고서 DSD (사업보고서 Template이 최신 내용이 아닌 경우)
(3) 사업보고서 작성 부서 엑셀 파일

### 2) 클라이언트 화면

![ec84ebac46b21269e6459bce0d489be4.png](../../_resources/ec84ebac46b21269e6459bce0d489be4.png)

<br>

_____
## (6) 사업보고서 대사
### 1) 기능 설명
**두 사업보고서 간 차이점을 대사하는 기능입니다.** 
현재 기준 DSD와 비교 대상 DSD를 입력 후 실행해주시면 사업보고서 대사 파일이 생성됩니다.

<br>

### 2) 클라이언트 화면

![client_step5.jpg](../../_resources/client_step5.jpg)

<br>

___
# 2. 부서별 Template 작성 가이드

## (1) 개요

### 1) 필수 글씨와 필수 표
####  필수 글씨는 다음과 같습니다.

- 각 단락의 제목, 중요 안내문구 등으로 DSD와 동일한 색으로 칠해져 있습니다.
- 🚫 Dart 표준 양식 상 **필수 글씨는 삭제 및 다른 위치로 이동될 수 없습니다.** 
- 📌따라서 **부서별 Template 작성** 시에도 **삭제 및 다른 위치로 이동**해서는 안됩니다.

![blue_text2.jpg](../../_resources/blue_text2.jpg)
![blue_text1.jpg](../../_resources/blue_text1.jpg)

#### 필수 표는 다음과 같습니다.

![blue_table1.jpg](../../_resources/blue_table1.jpg)

<br>

- 필수 표는  **파란색 테두리**로 표시되어 있으며 Template 상 **유일한 이름으로 정의**되어 있습니다.
	- 🚫 Dart 표준 양식 상 **필수 표는 다음의 제약 사항이 있습니다.**
		1.  열 추가 및 열 삭제 불가(고정 양식)
		2. 행 추가 및 행 삭제 가능 여부 각 행마다 상이
		3. 셀 병합 설정 및 해제 불가(고정 양식)

- 📌따라서 **부서별 Template 작성** 시에도 **다음의 제약 사항이 있습니다.**
	1. 임의의 열 추가 및 열 삭제 금지
	2. 행 추가 및 행 삭제 **리본 메뉴(BRS Editor) 이용**
	4. 임의의 셀 병합 설정 및 해제 금지

- 🚫(예시) **부서별 Template 작성** 시 다음의 행위를 **지양**하여 주시기 바랍니다.
	1. 필수 표의 전부 또는 일부 영역을 선택하여 잘라내기(Ctrl + X) 하는 행위
	> 필수 표에 설정된 이름 정의가 의도한 바와 다르게 변경되어 Dart 표준 양식에 맞춰 DSD 생성이 되지 않습니다.
	2. 필수 표에 임의의 열 추가/열 삭제/ 병합 정보의 변경을 시도하는 행위
	>  Dart 표준 양식에 내장된 해당 필수 표의 특성과 엑셀에서 작성하신 표의 특성과 상이하여 DSD 생성이 되지 않습니다.
	3.  **리본 메뉴(BRS Editor) 이용**하지 않고 임의의 행 추가/행 삭제를 하는 행위
	> Dart 표준 양식에 내장된 해당 필수 표의 특성과 엑셀에서 작성하신 표의 특성과 상이하여 DSD 생성이 되지 않습니다.
	4. 필수표의 위치를 **임의의 장소로 이동** 시키는 행위 (복사/잘라내기/붙여넣기 등)
	> 필수 표의 위치 역시 Dart 표준 양식에 내장되어 있습니다. 필수 표를 수정하는 것은 오직 행 추가 / 행 삭제 및 내용 작성에 한하여 가능합니다.

<br>

#### 필수 글씨와 필수 표 외 글씨와 표는 일반 글씨 및 일반 표로 지칭합니다.

- 필수 표를 포함한 모든 표는 다음과 같은 조건을 만족해야 합니다.

	- 표의 모든 테두리가 정상적으로 설정되어 있음
	- 표의 끝에는 "⤷테이블 끝" 문구가 위치함
	
	> 이는 표의 영역을 정상적으로 식별하기 위한 필수적인 절차입니다.

- 🚫(예시) 잘못된 일반 표 작성(필수 표도 동일)

	> 우측 상단 테두리가 올바르게 설정되어 있지 않습니다. 이 경우 표의 영역을 정상적으로 식별하기 어렵습니다.

![normal_table_error1.jpg](../../_resources/normal_table_error1.jpg)

- **일반 표 및 일반 글씨**의 경우 다음의 사항만 **주의**하여 주시기 바랍니다.
   -  일반 표 등을 수정하실 때 **전체 열 추가 / 열 삭제 등의 행위로** 인해서 **필수 글씨나 필수 표가 의도치않게 변경되는 경우**

<br>

___
## (2) 리본메뉴(BRS Editor)
BRS Editor는 부서별 Template의 작성 및 검증을 위하여 만들어진 PwC만의 리본 메뉴입니다.

BRS Editor의 구조는 아래와 같이 네 가지 부분으로 이루어집니다.

1.  개별/전체 검증 부분
2.  표시 변경 부분 
3.  필수표 메뉴 부분
4.  작성 가이드 메뉴 부분

![ribbonmenu1.jpg](../../_resources/ribbonmenu1.jpg)

<br>

___
## (3) 개별/전체 검증

**부서별 Template** 작성을 올바르게 수행하였는지 검증하는 기능입니다.
**검증 수행 시** 아래와 같은 검증을 수행합니다.


1. 필수 표 테두리 검증
2.  필수 표 행/열/병합 정보 검증
3.  필수 표가 표준 XML을 준수하는 지 여부 검증
4.  일반 표 테두리 검증
	
> 📌 Dart 표준 양식 상 표준 XML을 준수하지 않는 경우 DSD 생성이 불가능합니다.

![vaild1.jpg](../../_resources/vaild1.jpg)


 - 검증 내역 및 검증 결과를 확인하시고, 관련 내용이 부서별 Template 작성 가이드를 준수하였는지 검토해주시기 바랍니다.
 - 검증 결과 실제로 검토가 필요한 부분은 검증 결과 상 링크 열 [위치로 이동]()을 통하여 편하게 확인할 수 있습니다.
- **검증 완료 시** 아래와 같은 결과를 확인하실 수 있습니다.

![vaild2.jpg](../../_resources/vaild2.jpg)

<br>

___
## (4) 표시 변경

검증이 모두 정상적으로 마무리된 경우 **작성 완료** 기능을 수행합니다.

- 작업 현황이 **작업 완료**로 변경되며, **모든 시트에 보호가 생성**되어 시트의 내용을 변경할 수 없습니다.

![notice1.jpg](../../_resources/notice1.jpg)

- 만일 작성 완료를 수행한 후 추가 작업이 필요한 경우 **재작성** 기능을 수행합니다.
	작업 현황이 **작업 중**으로 변경되며, 모든 시트의 보호가 해제됩니다.
	
![notice2.jpg](../../_resources/notice2.jpg)
___
## (5) 필수 표 메뉴 

**필수 표 메뉴는 필수 표의 행 추가 및 행 삭제를 위한 기능을 제공합니다.**

- 필수표 행 추가 및 행 삭제는 기본적으로 **필수 표의 영역 내 본문 행**에서만 작동합니다.<br> 만일 필수 표의 영역이 아니거나 제목 행인 경우 다음과 같이 행 추가 및 행 삭제가 수행되지 않습니다.

<br>

**1.  필수 표의 영역 구분**<br>

![bluetable_area.jpg](../../_resources/bluetable_area.jpg)


- 필수 표의 영역이 아닌 경우 안내 메시지

![notice3.jpg](../../_resources/notice3.jpg)


- 필수 표의 제목 행인 경우
제목 행이 두 줄 이상인 경우 **셀 배경 색**을 기준으로 제목 행을 판별합니다.<br> **회색**의 경우 제목 행으로 간주됩니다.

![notice4.jpg](../../_resources/notice4.jpg)

<br>

**2. 필수 표 행 추가**

- 추가할 행 수를 1 이상의 정수로 입력합니다.
- Dart 표준 양식 상 행 추가가 불가능한 행의 경우 추가가 되지 않습니다.

![add_row.jpg](../../_resources/add_row.jpg)

<br>

**3. 필수 표 행 삭제**

- 삭제할 행 수를 1 이상의 정수로 입력합니다.
- Dart 표준 양식 상 행 삭제가 불가능한 행의 경우 삭제가 되지 않습니다.
-  그외 로직 상 삭제가 불가능한 경우 안내 창과 함께 행 삭제 기능이 실행되지 않습니다.

![del_row.jpg](../../_resources/del_row.jpg)

<br>

4. 필수 표 테두리 칠하기(선택 기능)

- 선택된 영역의 필수 표 테두리를 적절한 방식으로 생성합니다.
- 편의를 위한 선택 기능으로 필요하실 경우 사용 부탁 드립니다.
<br> 

___

## (6) 작성가이드 메뉴

**작성가이드 메뉴**는 **Dart 표준 작성 가이드**에 대해 아래와 같은 기능을 제공 합니다.

- Dart 표준 작성 가이드에 대한 Tree View 형식의 열람
- 다수의 작성 기준에 대한 즐겨찾기 기능(선택사항 메뉴)
- 회사만의 작성 기준이 별도로 존재할 경우를 위한 사용자 기재사항의 저장 기능
<br>

1. 최초 작성 (Initial Template에서 일괄적으로 세팅)

- 작성 가이드 목차 선택
- 원문 영역에서 저장하고 싶은 부분 선택 및 선택 사항에 서 확인
- 사용자 기재사항에 회사별 가이드 기입
- 창을 닫아 사용자 작업 사항 저장 (AU열에 G1 등의 표시 확인)


![guide1.jpg](../../_resources/guide1.jpg)


2. 작성 내역 확인 (기존 작성 부분)

- AU 열 G1 클릭 및  작성 가이드 열기 기능 수행

![guide2.jpg](../../_resources/guide2.jpg)


- 선택 내역 및 작성 내역 확인 가능
- 만일 해당 화면이 짤려서 나오는 경우 아래 사항 확인
	-  바탕화면 - 디스플레이 설정 - 화면 배율 - 100% 이하 여부

![guide3.jpg](../../_resources/guide3.jpg)

