# 사업보고서 Wizard 메뉴얼
[사업보고서 Wizard 메뉴얼 사이트 바로가기](https://assuranceda.github.io/BusinessReport_Wizard/)

___
# 1. 실행 클라이언트 가이드
## (1) Initial Template 생성
### 1) 단계 설명
**본 단계는 최초 사업보고서 Initial Template를 생성하는 단계입니다.<br>**
다음의 자료를 토대로 엑셀 기반의 사업보고서 작성을 위한 Template를 생성합니다.

(1) 전년 동기 DSD 
(2) 직전 분기 DSD 
(3) 사업보고서 작성 부서 엑셀 파일

> Ex) 2023년 기말 사업보고서 작성 시
> (1) 전년 동기 DSD는 2022년 기말 사업보고서 DSD이며,
> (2) 직전 분기 DSD는 2023년 3분기 보고서 DSD입니다.

<br>

### 2) 클라이언트 화면

![client_step1.jpg](../../_resources/client_step1.jpg)

<br>

### 3) 사업보고서 작성 부서 엑셀 파일 작성
작성 부서 엑셀 파일 A열에 아래와 같이 부서명을 아래 방향으로 기재합니다.
만일 동일 부서 내 담당자가 여러명인 경우 회계팀1 / 회계팀2 등으로 기재 부탁 드립니다.

![작성부서엑셀1.jpg](../../_resources/작성부서엑셀1.jpg)

<br>

### 4) 사업보고서 버전 업데이트
#### 사업보고서 업데이트 될 시 아래와 같은 절차로 진행해주셔야 합니다.

#### 1. 신규 사업보고서 문서 생성
(작성하시는 보고서 종류에 따라서 사업보고서 / 반기보고서 / 분기보고서 각각 수행)

- Dart 편집기 상 새문서 - 사업보고서(일반법인) 더블클릭

위 작업을 최초로 수행할  특정 경로에 자동으로 관련 양식이 업데이트 되며 사업보고서 Wizard는 이를 이용합니다.

![dart_editor.jpg](../../_resources/dart_editor.jpg)
<br>

#### 2. 이전 버전의 전년 동기 및 직전 분기 DSD 실행 및 신규 버전으로 업데이트
Input DSD 파일이 최신 버전이 아닐 시 Dart 편집기로 실행 시 아래와 같은 안내 문구가 생성되고 "예"를 눌러 최신 버전으로 변환한 후 사용하셔야 이후 단계에서 최신 버전의 사업보고서가 생성됩니다.
<br>
#### 사업보고서 버전 업데이트 시 일부 개정된 양식의 경우 내용이 변경 될 수 있으므로 과거 버전의 DSD와 대사 후 사용하시는 것을 권장 드립니다.
<br>

![dart_updated.jpg](../../_resources/dart_updated.jpg)
<br>

#### 3. 1의 과정을 진행하지 않은 경우에는 아래와 같은 에러 문구가 발생할 수 있습니다.
이는 Input DSD는 최신 버전인 반면, 관련 양식은 존재하지 않기 때문에 발생하는 문제입니다.

#### 아래 안내사항이 보이는 경우 4)-1의 절차를 수행하여 주십시오.

![dart_file_error.jpg](../../_resources/dart_file_error.jpg)
<br>


___
## (2) 부서별 Template 생성
### 1) 단계 설명
**본 단계는 1-(1) 에서 생성된 엑셀 파일(xlsm)을 토대로 작성 부서 별 엑셀 파일(xlsm) N개를 생성합니다.**

1-(1)에서 생성한 사업보고서 Initial Template를 기반으로 아래와 같은 작업을 진행해주셔야 합니다.

(1) 사업보고서 작성 영역을 각 사업부 R&R에 맞게 분배 
(2) 사업보고서 내용 상 검증이 필요한 금액의 경우 검증표에 맵핑
(3) 부서별 Template 생성 결과인 separate_template 폴더 sharepoint 상에 업로드 및 "최종 파일 리스트.xlsx" 작성

<br>

### 2) 클라이언트 화면

![client_step2.jpg](../../_resources/client_step2.jpg)

<br>

### 3) 부서 맵핑
#### 부서 맵핑 개요 (DSD 시트 상 B~N열)
아래 화면에서 회계팀에서 빨간색으로 표시된 영역이 배정되었습니다.(10~13행)
또한 표의 영역이기 때문에  "⤷테이블 끝" 부분까지 올바르게 할당된 것을 알 수 있습니다.

- 회계팀에게 관련 부분을 배정하기 위해서는 회계팀의 열인 D열에 관련 영역을 O 표시하시면 됩니다.
<br>


>  Initial Template 상 DSD 시트

![DSD시트1.jpg](../../_resources/DSD시트1.jpg)
<br>


#### 기본 작성 방법
1. 위의 화면 상 B~L열에 대해서 BA열의 전년 동기 사업보고서 내용을 보시고 사업보고서 작성 부서(R&R)를 O 표시로 표시해주시기 바랍니다.
2. 감사보고서와 연결 감사보고서 내용은 각각 스마트리뷰어_별도(M열), 스마트리뷰어_연결(N열)로 자동 맵핑되어 있습니다. 1의 작업 시 이 부분은 생략하고 진행해주시면 되겠습니다.
3. 사업보고서 상 각 영역은 **하나의 부서**에게 할당 되어야 합니다.<br> 예를들어 하나의 표를 2개의 다른 부서에게 할당하는 것은 불가능합니다. 
4. 🚫 특히 필수 표의 경우 **Dart 표준 양식 상 반드시 지켜져야 하는 형식이 존재**하며, 여러 부서에게 할당되지 않도록 각별한 주의가 필요합니다.
5. 표의 경우 "⤷테이블 끝"까지 표의 영역이오니, 표의 영역을 할당하실 때에는 해당 부분까지 포함될 수 있도록 확인 부탁 드립니다.
<br>
#### 🚫 주의사항 - 다음과 같은 경우 오류가 발생합니다.
1. 하나의 필수 표 영역에 대해서 해당 영역의 일부 또는 전부를 다수의 부서에 배정하는 경우  
2. 사업보고서 상 동일 영역을 다수의 부서에 배정하는 경우
> Ex) 사업보고서라는 제목(6행)을 회계팀, 법무팀 등에 동시에 배정한 경우


<br>

### 4) 검증표 작성

#### 검증표 작성 개요
아래 화면 상 자금팀과 회계팀의 자본금은 동일하나, 경영기획팀의 자본금이 상이한 것을 알 수 있습니다.
관련 부분을 최초에 한번만 맵핑해주게 되면 추후 부서별 Template으로 나누어져서 새롭게 작성되어도 작성된 검증표에 대한 링크가 연결됩니다.

- 스마트리뷰어 별도/연결 파일의 경우 최종 DSD 생성 단계에서 합쳐지게 됩니다.
따라서 위 검증표 작성과는 별개로 스마트리뷰어 별도/연결 파일에도 검증표 생성 작업을 수행해주셔야 합니다.
(작성 방법은 동일하며 스마트리뷰어 파일 내 "reference_table"이라는 표를 생성한 후 작업해주시면 되겠습니다.(삽입-표 기능 활용) )

![검증표1.jpg](../../_resources/검증표1.jpg)

#### 기본 작성 방법
1. 모든 열은 작성이 되어 있어야 합니다.

2. 변수_ID는 다음과 같은 규칙으로 이루어져 있습니다.
	- "그룹번호-일련번호"
	- 같은 그룹 내 부여된 일련번호는 동일한 금액을 가져야 한다는 로직으로 검증이 진행됩니다.
	> Ex) 검증표 상 "그룹번호 101" 상 일련번호 001 / 002 / 003이 존재합니다.<br> 이때 자금팀과 회계팀의 금액은 382로 일치하나 경영기획팀의 금액은 261,911로 다른 팀의 금액들과 다릅니다.

3. 변수_이름과 비고는 자유로이 적어주시되, 서로 Refernce 되는 항목들은 동일하게 기재 부탁 드립니다.

4. 금액은 "DSD" 시트 상에서 셀 참조로 작성해주셔야 하며(ex: =DSD!BA54),
참조된 셀에 표시된 DSD 시트 상 부서 맵핑(동그라미(O) 표시)과 검증표 상 부서명은 일치해야 합니다.

5. 부서명은 5를 고려하여 작성해주시기 바랍니다.
<br>

#### 🚫 주의사항 - 다음과 같은 경우 **검증 오류로 Template 생성이 중단** 됩니다.
검증표 검증 실패로 인해 Template 생성이 중단될 시 검증 실패 내역 정리된 엑셀 파일을 통해 검증표 수정 후 재 시도 부탁 드립니다.(TBD)

1. DSD 시트 상 "회계부"에 동그라미(O) 표시 되어 있는 행과 관련 된 금액을 검증표 상 "자금부"의 금액으로 입력한 경우
2. 금액열을 DSD 상 셀 참조가 아닌 숫자로 Key-in하는 경우
3. 검증표 상 비어있는 셀이 있는 경우
<br>

### 5) 최종 파일 리스트 작성

#### 관련 개요
1-(2) 부서별 Template 생성을 진행하시게 되면 아래와 같이 사업보고서 Wizard가 위치하는 폴더에 separate_template 폴더가 생성됩니다.
해당 separate_template 폴더 안에는 각 부서별 폴더 및 부서별 Template이 위치하게 됩니다.
#### 해당 안의 파일을 Sharepoint 상 각 부서 폴더 안으로 업로드하여 작성 부서 별로 사업보고서 작성을 진행해주시면 되겠습니다.

이때, 스마트리뷰어_별도 및 스마트리뷰어_연결 폴더의 경우 최초 생성 시에 **빈 폴더**로 생성되며,<br> 회계팀에서 작성하신 **스마트리뷰어 파일을 관련 폴더**에 넣어주시기 바랍니다.

![separate_template.jpg](../../_resources/separate_template.jpg)
<br>

"최종 파일 리스트.xlsx"는 자동으로 생성되며, 최초 생성 시 스마트리뷰어 파일명을 확장자(.xlsm)와 함께 입력 부탁 드리겠습니다.<br>
만일 관련 파일명이나 폴더명이 변경된 경우 (3) 사업보고서 최종 DSD 생성 전 "최종 파일 리스트.xlsx"를 업데이트 해주셔야 합니다.

**🚫 "최종 파일 리스트.xlsx"의 이름은 고정 값으로 변경하셔서는 안됩니다.**

![최종파일리스트1.jpg](../../_resources/최종파일리스트1.jpg)

<br>

___
## (3) 사업보고서 최종 DSD 생성
### 1) 단계 설명
**본 단계는 1-(2) 에서 생성된 작성 부서 별 엑셀 파일(xlsm)을 토대로 최종적으로 사업보고서 DSD를 생성합니다.**
1-(2)에서 생성한 부서 별 Template를 기반으로 아래와 같은 작업을 진행해주셔야 합니다.

(1) 부서 별 Template 작성 가이드에 맞게 사업보고서 작성 및 검증 수행
(Sharepoint 상 엑셀 환경에서 진행)

(2) Sharepoint에서 작성된 Template을 하나의 압축 파일로 다운로드
(1-(2)-5) "최종 파일 리스트.xlsx" 작성 확인 필요)

<br>

### 2) 클라이언트 화면

![client_step3.jpg](../../_resources/client_step3.jpg)

<br>

___
## (4) Initial Rolling 작업 - TBD
### 1) 단계 설명
**본 단계는 최초 사업보고서 Initial Template를 생성하는 단계입니다. Initial Template 생성 대체 작업
<br>**



### 2) 클라이언트 화면

![client_step4.jpg](../../_resources/client_step4.jpg)

<br>

_____
## (5) 사업보고서 대사
### 1) 기능 설명
**두 사업보고서 간 차이점을 대사하는 기능입니다.** 
현재 기준 DSD와 비교 대상 DSD를 입력 후 실행해주시면 사업보고서 대사 파일이 생성됩니다.

<br>

### 2) 클라이언트 화면

![client_step5.jpg](../../_resources/client_step5.jpg)

<br>

___
# 2. 부서별 Template 작성 가이드

## (1) 개요

### 1) 필수 글씨와 필수 표
####  필수 글씨는 다음과 같습니다.

- 각 단락의 제목, 중요 안내문구 등으로 DSD와 동일한 색으로 칠해져 있습니다.
- 🚫 Dart 표준 양식 상 **필수 글씨는 삭제 및 다른 위치로 이동될 수 없습니다.** 
- 📌따라서 **부서별 Template 작성** 시에도 **삭제 및 다른 위치로 이동**해서는 안됩니다.

![필수글씨2.jpg](../../_resources/필수글씨2.jpg)
![필수글씨1.jpg](../../_resources/필수글씨1.jpg)

#### 필수 표는 다음과 같습니다.


![필수표1.jpg](../../_resources/필수표1.jpg)
<br>

- 필수 표는  **파란색 테두리**로 표시되어 있으며 Template 상 **유일한 이름으로 정의**되어 있습니다.
	- 🚫 Dart 표준 양식 상 **필수 표는 다음의 제약 사항이 있습니다.**
		1.  열 추가 및 열 삭제 불가(고정 양식)
		2. 행 추가 및 행 삭제 가능 여부 각 행마다 상이
		3. 셀 병합 설정 및 해제 불가(고정 양식)

- 📌따라서 **부서별 Template 작성** 시에도 **다음의 제약 사항이 있습니다.**
	1. 임의의 열 추가 및 열 삭제 금지
	2. 행 추가 및 행 삭제 **리본 메뉴(BRS Editor) 이용**
	4. 임의의 셀 병합 설정 및 해제 금지

- 🚫(예시) **부서별 Template 작성** 시 다음의 행위를 **지양**하여 주시기 바랍니다.
	1. 필수 표의 전부 또는 일부 영역을 선택하여 잘라내기(Ctrl + X) 하는 행위
	> 필수 표에 설정된 이름 정의가 의도한 바와 다르게 변경되어 Dart 표준 양식에 맞춰 DSD 생성이 되지 않습니다.
	2. 필수 표에 임의의 열 추가/열 삭제/ 병합 정보의 변경을 시도하는 행위
	>  Dart 표준 양식에 내장된 해당 필수 표의 특성과 엑셀에서 작성하신 표의 특성과 상이하여 DSD 생성이 되지 않습니다.
	3.  **리본 메뉴(BRS Editor) 이용**하지 않고 임의의 행 추가/행 삭제를 하는 행위
	> Dart 표준 양식에 내장된 해당 필수 표의 특성과 엑셀에서 작성하신 표의 특성과 상이하여 DSD 생성이 되지 않습니다.
	4. 필수표의 위치를 **임의의 장소로 이동** 시키는 행위 (복사/잘라내기/붙여넣기 등)
	> 필수 표의 위치 역시 Dart 표준 양식에 내장되어 있습니다. 필수 표를 수정하는 것은 오직 행 추가 / 행 삭제 및 내용 작성에 한하여 가능합니다.

<br>

#### 필수 글씨와 필수 표 외 글씨와 표는 일반 글씨 및 일반 표로 지칭합니다.

- 필수 표를 포함한 모든 표는 다음과 같은 조건을 만족해야 합니다.

	- 표의 모든 테두리가 정상적으로 설정되어 있음
	- 표의 끝에는 "⤷테이블 끝" 문구가 위치함
	
	> 이는 표의 영역을 정상적으로 식별하기 위한 필수적인 절차입니다.

- 🚫(예시) 잘못된 일반 표 작성(필수 표도 동일)

	> 우측 상단 테두리가 올바르게 설정되어 있지 않습니다. 이 경우 표의 영역을 정상적으로 식별하기 어렵습니다.

![일반표오류1.jpg](../../_resources/일반표오류1.jpg)

- **일반 표 및 일반 글씨**의 경우 다음의 사항만 **주의**하여 주시기 바랍니다.
   -  일반 표 등을 수정하실 때 **전체 열 추가 / 열 삭제 등의 행위로** 인해서 **필수 글씨나 필수 표가 의도치않게 변경되는 경우**

<br>

___
## (2) 리본메뉴(BRS Editor)
BRS Editor는 부서별 Template의 작성 및 검증을 위하여 만들어진 PwC만의 리본 메뉴입니다.

BRS Editor의 구조는 아래와 같이 네 가지 부분으로 이루어집니다.

1.  개별/전체 검증 부분
2.  표시 변경 부분 
3.  필수표 메뉴 부분
4.  작성 가이드 메뉴 부분

![리본메뉴1.jpg](../../_resources/리본메뉴1.jpg)

<br>

___
## (3) 개별/전체 검증

**부서별 Template** 작성을 올바르게 수행하였는지 검증하는 기능입니다.
**검증 수행 시** 아래와 같은 검증을 수행합니다.


1. 필수 표 테두리 검증
2.  필수 표 행/열/병합 정보 검증
3.  필수 표가 표준 XML을 준수하는 지 여부 검증
4.  일반 표 테두리 검증
	
> 📌 Dart 표준 양식 상 표준 XML을 준수하지 않는 경우 DSD 생성이 불가능합니다.

![검증1.jpg](../../_resources/검증1.jpg)

 - 검증 내역 및 검증 결과를 확인하시고, 관련 내용이 부서별 Template 작성 가이드를 준수하였는지 검토해주시기 바랍니다.
 - 검증 결과 실제로 검토가 필요한 부분은 검증 결과 상 링크 열 [위치로 이동]()을 통하여 편하게 확인할 수 있습니다.
- **검증 완료 시** 아래와 같은 결과를 확인하실 수 있습니다.

![검증2.jpg](../../_resources/검증2.jpg)

<br>

___
## (4) 표시 변경

검증이 모두 정상적으로 마무리된 경우 **작성 완료** 기능을 수행합니다.

- 작업 현황이 **작업 완료**로 변경되며, **모든 시트에 보호가 생성**되어 시트의 내용을 변경할 수 없습니다.

![안내1.jpg](../../_resources/안내1.jpg)

- 만일 작성 완료를 수행한 후 추가 작업이 필요한 경우 **재작성** 기능을 수행합니다.
	작업 현황이 **작업 중**으로 변경되며, 모든 시트의 보호가 해제됩니다.

![안내2.jpg](../../_resources/안내2.jpg)

___
## (5) 필수 표 메뉴 

**필수 표 메뉴는 필수 표의 행 추가 및 행 삭제를 위한 기능을 제공합니다.**

- 필수표 행 추가 및 행 삭제는 기본적으로 **필수 표의 영역 내 본문 행**에서만 작동합니다.<br> 만일 필수 표의 영역이 아니거나 제목 행인 경우 다음과 같이 행 추가 및 행 삭제가 수행되지 않습니다.

<br>

**1.  필수 표의 영역 구분**<br>
![필수표영역.jpg](../../_resources/필수표영역.jpg)

- 필수 표의 영역이 아닌 경우 안내 메시지

![안내3.jpg](../../_resources/안내3.jpg)

- 필수 표의 제목 행인 경우
제목 행이 두 줄 이상인 경우 **셀 배경 색**을 기준으로 제목 행을 판별합니다.<br> **회색**의 경우 제목 행으로 간주됩니다.

![안내4.jpg](../../_resources/안내4.jpg)

<br>

**2. 필수 표 행 추가**

- 추가할 행 수를 1 이상의 정수로 입력합니다.
- Dart 표준 양식 상 행 추가가 불가능한 행의 경우 추가가 되지 않습니다.

![행추가.jpg](../../_resources/행추가.jpg)

<br>

**3. 필수 표 행 삭제**

- 삭제할 행 수를 1 이상의 정수로 입력합니다.
- Dart 표준 양식 상 행 삭제가 불가능한 행의 경우 삭제가 되지 않습니다.
-  그외 로직 상 삭제가 불가능한 경우 안내 창과 함께 행 삭제 기능이 실행되지 않습니다.

![행삭제.jpg](../../_resources/행삭제.jpg)

<br>

4. 필수 표 테두리 칠하기(선택 기능)

- 선택된 영역의 필수 표 테두리를 적절한 방식으로 생성합니다.
- 편의를 위한 선택 기능으로 필요하실 경우 사용 부탁 드립니다.
<br> 

___

## (6) 작성가이드 메뉴

**작성가이드 메뉴**는 **Dart 표준 작성 가이드**에 대해 아래와 같은 기능을 제공 합니다.

- Dart 표준 작성 가이드에 대한 Tree View 형식의 열람
- 다수의 작성 기준에 대한 즐겨찾기 기능(선택사항 메뉴)
- 회사만의 작성 기준이 별도로 존재할 경우를 위한 사용자 기재사항의 저장 기능
<br>

1. 최초 작성 (Initial Template에서 일괄적으로 세팅)

- 작성 가이드 목차 선택
- 원문 영역에서 저장하고 싶은 부분 선택 및 선택 사항에 서 확인
- 사용자 기재사항에 회사별 가이드 기입
- 창을 닫아 사용자 작업 사항 저장 (AU열에 G1 등의 표시 확인)

![작성가이드1.jpg](../../_resources/작성가이드1.jpg)


2. 작성 내역 확인 (기존 작성 부분)

- AU 열 G1 클릭 및  작성 가이드 열기 기능 수행

![작성가이드2.jpg](../../_resources/작성가이드2.jpg)

- 선택 내역 및 작성 내역 확인 가능
- 만일 해당 화면이 짤려서 나오는 경우 아래 사항 확인
	-  바탕화면 - 디스플레이 설정 - 화면 배율 - 100% 이하 여부

![작성가이드3.jpg](../../_resources/작성가이드3.jpg)

